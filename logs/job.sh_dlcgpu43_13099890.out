{'backbone': 'efficientnet_b2', 'batch_size': 128, 'bn_eps': None, 'bn_momentum': None, 'checkpoints_root': 'Checkpoints/timm_explore_few_epochs/', 'clip_grad': None, 'clip_mode': 'norm', 'comet_api_key': 'KKiKMVZI9RCYowoKDZDS5Y2km', 'comet_workspace': 'rsukthanker', 'cooldown_epochs': 10, 'dataset': 'CelebA', 'decay_epochs': 2.4, 'decay_rate': 0.97, 'default_test_root': '/work/dlclarge2/sukthank-ZCP_Competition/FairNAS/FR-NAS/data/CelebA/Img/img_align_celeba_splits/test/', 'default_train_root': '/work/dlclarge2/sukthank-ZCP_Competition/FairNAS/FR-NAS/data/CelebA/Img/img_align_celeba_splits/train/', 'demographics_file': 'CelebA/CelebA_demographics.txt', 'dist_bn': 'reduce', 'drop': 0.3, 'drop_block': None, 'drop_connect': 0.2, 'drop_path': None, 'epoch_repeats': 0.0, 'epochs': 450, 'file_name': 'timm_from-scratch.csv', 'file_name_ema': 'timm_from-scratch_ema.csv', 'gp': None, 'groups_to_modify': ['male', 'female'], 'head': 'CosFace', 'input_size': 112, 'layer_decay': None, 'lr': 0.016, 'lr_cycle_decay': 0.5, 'lr_cycle_limit': 1, 'lr_cycle_mul': 1.0, 'lr_k_decay': 1.0, 'lr_noise': None, 'lr_noise_pct': 0.67, 'lr_noise_std': 1.0, 'mean': [0.5, 0.5, 0.5], 'metadata_file': 'timm_model_metadata.csv', 'min_lr': 1e-06, 'min_num_images': 3, 'model_ema': True, 'model_ema_decay': 0.9999, 'model_ema_force_cpu': False, 'momentum': 0.9, 'name': 'CelebA', 'num_workers': 4, 'opt': 'RMSpropTF', 'opt_betas': None, 'opt_eps': 0.001, 'out_dir': '.', 'p_identities': [1.0, 1.0], 'p_images': [1.0, 1.0], 'patience_epochs': 10, 'pretrained': False, 'project_name': 'from-scratch_no-resampling_adam', 'save_freq': 1, 'sched': 'step', 'seed': 222, 'split_bn': False, 'start_epoch': None, 'std': [0.5, 0.5, 0.5], 'sync_bn': False, 'torchscript': False, 'train_loss': 'Focal', 'user_config': 'config_user.yaml', 'warmup_epochs': 3, 'warmup_lr': 1e-06, 'weight_decay': 1e-05}
P identities: {'male': 1.0, 'female': 1.0}
P images: {'male': 1.0, 'female': 1.0}
COMET INFO: Experiment is live on comet.ml https://www.comet.ml/rsukthanker/from-scratch-no-resampling-adam/096b4f0d19b5420ab16d0c58f268403e

PREPARING TRAIN DATASET
Overall # of images for male available is 67562
# images selected for male is 67562
Overall # of images for female available is 76524
# images selected for female is 67562
Number of idx for male is 3529
Number of idx for female is 3529
PREPARING TEST DATASET
Overall # of images for male available is 7644
# images selected for male is 7636
Overall # of images for female available is 8851
# images selected for female is 7636
Number of idx for male is 406
Number of idx for female is 406
Len of train dataloader is 1055
Len of test dataloader is 120
WARNING: 'drop_connect' as an argument is deprecated, please use 'drop_path'. Setting drop_path to 0.200000.
Checkpoint_Head_CosFace_Backbone_efficientnet_b2_Dataset_CelebA_p_idx{'male': 1.0, 'female': 1.0}_p_img{'male': 1.0, 'female': 1.0}_Epoch_
Found checkpoints for this model: []
No Checkpoints Found at 'Checkpoints/timm_explore_few_epochs/efficientnet_b2_CosFace'. Please Have a Check or Continue to Train from Scratch
Start training
  0%|          | 0/1055 [00:00<?, ?it/s]  0%|          | 1/1055 [00:15<4:28:28, 15.28s/it]  0%|          | 2/1055 [00:15<1:54:11,  6.51s/it]  0%|          | 3/1055 [00:15<1:04:10,  3.66s/it]  0%|          | 4/1055 [00:16<40:36,  2.32s/it]    0%|          | 5/1055 [00:16<28:02,  1.60s/it]  1%|          | 6/1055 [00:16<20:04,  1.15s/it]  1%|          | 7/1055 [00:17<14:54,  1.17it/s]  1%|          | 8/1055 [00:17<11:38,  1.50it/s]  1%|          | 9/1055 [00:17<09:49,  1.77it/s]  1%|          | 10/1055 [00:17<08:07,  2.14it/s]  1%|          | 11/1055 [00:18<07:01,  2.48it/s]  1%|          | 12/1055 [00:18<06:12,  2.80it/s]  1%|          | 13/1055 [00:18<06:02,  2.87it/s]  1%|▏         | 14/1055 [00:18<05:37,  3.08it/s]  1%|▏         | 15/1055 [00:19<05:17,  3.27it/s]  2%|▏         | 16/1055 [00:19<05:26,  3.18it/s]  2%|▏         | 17/1055 [00:19<05:07,  3.37it/s]  2%|▏         | 18/1055 [00:20<04:55,  3.51it/s]  2%|▏         | 19/1055 [00:20<04:49,  3.58it/s]  2%|▏         | 20/1055 [00:20<05:05,  3.38it/s]  2%|▏         | 21/1055 [00:20<04:54,  3.51it/s]  2%|▏         | 22/1055 [00:21<04:47,  3.59it/s]  2%|▏         | 23/1055 [00:21<04:38,  3.70it/s]  2%|▏         | 24/1055 [00:21<04:56,  3.48it/s]  2%|▏         | 25/1055 [00:22<04:44,  3.62it/s]  2%|▏         | 26/1055 [00:22<04:37,  3.70it/s]  3%|▎         | 27/1055 [00:22<04:55,  3.47it/s]  3%|▎         | 28/1055 [00:22<04:43,  3.62it/s]  3%|▎         | 29/1055 [00:23<04:35,  3.73it/s]  3%|▎         | 30/1055 [00:23<04:34,  3.73it/s]  3%|▎         | 31/1055 [00:23<04:55,  3.47it/s]  3%|▎         | 32/1055 [00:23<04:45,  3.59it/s]  3%|▎         | 33/1055 [00:24<04:38,  3.67it/s]  3%|▎         | 34/1055 [00:24<05:00,  3.40it/s]  3%|▎         | 35/1055 [00:24<04:47,  3.55it/s]  3%|▎         | 36/1055 [00:25<04:42,  3.61it/s]  4%|▎         | 37/1055 [00:25<04:34,  3.72it/s]  4%|▎         | 38/1055 [00:25<04:53,  3.47it/s]  4%|▎         | 39/1055 [00:25<04:42,  3.59it/s]  4%|▍         | 40/1055 [00:26<04:38,  3.65it/s]  4%|▍         | 41/1055 [00:26<04:54,  3.44it/s]  4%|▍         | 42/1055 [00:26<04:47,  3.52it/s]  4%|▍         | 43/1055 [00:27<04:41,  3.59it/s]  4%|▍         | 44/1055 [00:27<04:32,  3.71it/s]  4%|▍         | 45/1055 [00:27<04:54,  3.42it/s]  4%|▍         | 46/1055 [00:27<04:42,  3.57it/s]  4%|▍         | 47/1055 [00:28<04:33,  3.69it/s]  5%|▍         | 48/1055 [00:28<04:26,  3.78it/s]  5%|▍         | 49/1055 [00:28<04:46,  3.51it/s]  5%|▍         | 50/1055 [00:29<04:36,  3.63it/s]  5%|▍         | 51/1055 [00:29<04:34,  3.66it/s]  5%|▍         | 52/1055 [00:29<04:53,  3.42it/s]  5%|▌         | 53/1055 [00:29<04:39,  3.58it/s]  5%|▌         | 54/1055 [00:30<04:31,  3.69it/s]  5%|▌         | 55/1055 [00:30<04:21,  3.82it/s]  5%|▌         | 56/1055 [00:30<04:40,  3.56it/s]  5%|▌         | 57/1055 [00:30<04:34,  3.64it/s]  5%|▌         | 58/1055 [00:31<04:29,  3.71it/s]  6%|▌         | 59/1055 [00:31<04:24,  3.76it/s]  6%|▌         | 60/1055 [00:31<04:39,  3.56it/s]  6%|▌         | 61/1055 [00:32<04:34,  3.62it/s]  6%|▌         | 62/1055 [00:32<04:24,  3.76it/s]  6%|▌         | 63/1055 [00:32<04:43,  3.50it/s]  6%|▌         | 64/1055 [00:32<04:30,  3.66it/s]  6%|▌         | 65/1055 [00:33<04:24,  3.75it/s]  6%|▋         | 66/1055 [00:33<04:19,  3.81it/s]  6%|▋         | 67/1055 [00:33<04:37,  3.56it/s]  6%|▋         | 68/1055 [00:33<04:28,  3.67it/s]  7%|▋         | 69/1055 [00:34<04:21,  3.77it/s]  7%|▋         | 70/1055 [00:34<04:39,  3.52it/s]  7%|▋         | 71/1055 [00:34<04:31,  3.63it/s]  7%|▋         | 72/1055 [00:35<04:24,  3.71it/s]  7%|▋         | 73/1055 [00:35<04:20,  3.77it/s]  7%|▋         | 74/1055 [00:35<04:43,  3.46it/s]  7%|▋         | 75/1055 [00:35<04:33,  3.58it/s]  7%|▋         | 76/1055 [00:36<04:32,  3.59it/s]  7%|▋         | 77/1055 [00:36<04:40,  3.49it/s]  7%|▋         | 78/1055 [00:36<04:29,  3.62it/s]  7%|▋         | 79/1055 [00:36<04:20,  3.74it/s]  8%|▊         | 80/1055 [00:37<04:12,  3.86it/s]  8%|▊         | 81/1055 [00:37<04:34,  3.55it/s]  8%|▊         | 82/1055 [00:37<04:25,  3.66it/s]  8%|▊         | 83/1055 [00:38<04:22,  3.71it/s]  8%|▊         | 84/1055 [00:38<04:17,  3.77it/s]  8%|▊         | 85/1055 [00:38<04:34,  3.54it/s]  8%|▊         | 86/1055 [00:38<04:23,  3.68it/s]  8%|▊         | 87/1055 [00:39<04:21,  3.70it/s]  8%|▊         | 88/1055 [00:39<04:34,  3.52it/s]  8%|▊         | 89/1055 [00:39<04:24,  3.65it/s]  9%|▊         | 90/1055 [00:39<04:20,  3.71it/s]  9%|▊         | 91/1055 [00:40<04:16,  3.75it/s]  9%|▊         | 92/1055 [00:40<04:35,  3.49it/s]  9%|▉         | 93/1055 [00:40<04:25,  3.63it/s]  9%|▉         | 94/1055 [00:41<04:20,  3.68it/s]  9%|▉         | 95/1055 [00:41<04:16,  3.75it/s]  9%|▉         | 96/1055 [00:41<04:32,  3.52it/s]  9%|▉         | 97/1055 [00:41<04:24,  3.62it/s]  9%|▉         | 98/1055 [00:42<04:13,  3.77it/s]  9%|▉         | 99/1055 [00:42<04:30,  3.53it/s]  9%|▉         | 100/1055 [00:42<04:20,  3.67it/s] 10%|▉         | 101/1055 [00:42<04:15,  3.73it/s] 10%|▉         | 102/1055 [00:43<04:11,  3.80it/s] 10%|▉         | 103/1055 [00:43<04:26,  3.58it/s] 10%|▉         | 104/1055 [00:43<04:16,  3.70it/s] 10%|▉         | 105/1055 [00:44<04:12,  3.77it/s] 10%|█         | 106/1055 [00:44<04:33,  3.47it/s] 10%|█         | 107/1055 [00:44<04:26,  3.56it/s] 10%|█         | 108/1055 [00:44<04:17,  3.68it/s] 10%|█         | 109/1055 [00:45<04:10,  3.77it/s] 10%|█         | 110/1055 [00:45<04:24,  3.57it/s] 11%|█         | 111/1055 [00:45<04:17,  3.66it/s] 11%|█         | 112/1055 [00:45<04:14,  3.71it/s] 11%|█         | 113/1055 [00:46<04:29,  3.50it/s] 11%|█         | 114/1055 [00:46<04:19,  3.62it/s] 11%|█         | 115/1055 [00:46<04:09,  3.77it/s] 11%|█         | 116/1055 [00:47<04:08,  3.77it/s] 11%|█         | 117/1055 [00:47<04:26,  3.52it/s] 11%|█         | 118/1055 [00:47<04:16,  3.65it/s] 11%|█▏        | 119/1055 [00:47<04:13,  3.69it/s] 11%|█▏        | 120/1055 [00:48<04:08,  3.77it/s] 11%|█▏        | 121/1055 [00:48<04:24,  3.53it/s]